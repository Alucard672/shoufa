# 图片上传功能说明

## 功能概述

款号管理支持上传款式图片，图片存储在微信云存储中。

## 数据库字段

### styles 表新增字段

| 字段名 | 类型 | 说明 |
|--------|------|------|
| imageUrl | String | 云存储文件ID（格式：`cloud://xxx`） |

## 云存储配置

### 存储路径

图片存储在云存储的 `styles/` 目录下，文件命名格式：
```
styles/{timestamp}_{randomStr}.{extension}
```

例如：`styles/1703123456789_abc123.jpg`

### 文件大小限制

- 最大文件大小：5MB
- 支持格式：JPG、PNG 等常见图片格式

## 实现方式

### 客户端上传

使用微信小程序原生 API `wx.cloud.uploadFile` 直接上传，无需额外的云函数。

```javascript
// 上传图片
const uploadResult = await wx.cloud.uploadFile({
  cloudPath: `styles/${timestamp}_${randomStr}${fileExtension}`,
  filePath: filePath
})

// 获取文件ID
const fileID = uploadResult.fileID
```

### 图片显示

使用 `<image>` 标签直接显示云存储文件ID：

```xml
<image src="{{item.imageUrl}}" mode="aspectFill"></image>
```

## 云函数

**无需新增云函数**，图片上传直接使用客户端 API。

## 注意事项

1. **云存储权限**：确保云存储已开通并配置正确的权限
2. **文件删除**：删除款号时，建议同时删除关联的云存储文件（可选）
3. **默认图片**：如果款号没有图片，可以显示默认占位图
4. **图片压缩**：上传时使用 `sizeType: ['compressed']` 自动压缩图片

## 相关文件

- `pages/style/create.js` - 图片上传逻辑
- `pages/style/create.wxml` - 图片上传UI
- `pages/style/index.wxml` - 图片显示


