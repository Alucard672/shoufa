<!--pages/settings/tenant.wxml-->
<view class="container">
  <!-- 搜索栏 -->
  <view class="search-section">
    <view class="search-box">
      <image class="search-icon" src="/images/icons/search.svg" mode="aspectFit"></image>
      <input 
        class="search-input" 
        placeholder="搜索租户名称、联系人、电话" 
        value="{{searchKeyword}}"
        bindinput="onSearch"
      />
    </view>
  </view>

  <!-- 租户列表 -->
  <view class="section">
    <view class="list-header">
      <text class="list-title">租户列表</text>
      <view class="btn btn-primary btn-small" bindtap="onAddTenant">
        <text>+ 新增租户</text>
      </view>
    </view>

    <view class="tenant-list">
      <view 
        class="tenant-card card" 
        wx:for="{{tenants}}" 
        wx:key="id"
        wx:if="{{!searchKeyword || tenant.name.indexOf(searchKeyword) >= 0 || (tenant.contact && tenant.contact.indexOf(searchKeyword) >= 0) || (tenant.phone && tenant.phone.indexOf(searchKeyword) >= 0)}}"
      >
        <view class="tenant-info">
          <view class="tenant-header">
            <text class="tenant-name">{{tenant.name}}</text>
            <view class="tenant-actions">
              <view class="action-btn" bindtap="onEditTenant" data-tenant="{{tenant}}">
                <text>编辑</text>
              </view>
              <view class="action-btn action-btn-danger" bindtap="onDelete" data-tenant="{{tenant}}">
                <text>删除</text>
              </view>
            </view>
          </view>
          <view class="tenant-details">
            <view class="detail-item" wx:if="{{tenant.contact}}">
              <text class="detail-label">联系人：</text>
              <text class="detail-value">{{tenant.contact}}</text>
            </view>
            <view class="detail-item" wx:if="{{tenant.phone}}">
              <text class="detail-label">电话：</text>
              <text class="detail-value">{{tenant.phone}}</text>
            </view>
            <view class="detail-item" wx:if="{{tenant.address}}">
              <text class="detail-label">地址：</text>
              <text class="detail-value">{{tenant.address}}</text>
            </view>
          </view>
        </view>
      </view>

      <view class="empty-state" wx:if="{{tenants.length === 0}}">
        <text class="empty-text">暂无租户数据</text>
      </view>
    </view>
  </view>

  <!-- 新增/编辑弹窗 -->
  <view class="modal-overlay" wx:if="{{showAddModal}}" bindtap="onCloseModal">
    <view class="modal-content" catchtap="stopPropagation">
      <view class="modal-header">
        <text class="modal-title">{{editTenant ? '编辑租户' : '新增租户'}}</text>
        <view class="close-btn" bindtap="onCloseModal">
          <image class="close-icon" src="/images/icons/close.svg" mode="aspectFit"></image>
        </view>
      </view>

      <view class="modal-body">
        <view class="form-item">
          <text class="form-label">租户名称 *</text>
          <input 
            class="form-input" 
            placeholder="请输入租户名称" 
            value="{{tenantName}}"
            bindinput="onTenantNameInput"
          />
        </view>

        <view class="form-item">
          <text class="form-label">联系人</text>
          <input 
            class="form-input" 
            placeholder="请输入联系人" 
            value="{{contact}}"
            bindinput="onContactInput"
          />
        </view>

        <view class="form-item">
          <text class="form-label">联系电话</text>
          <input 
            class="form-input" 
            type="number"
            placeholder="请输入联系电话" 
            value="{{phone}}"
            bindinput="onPhoneInput"
          />
        </view>

        <view class="form-item">
          <text class="form-label">地址</text>
          <textarea 
            class="form-textarea" 
            placeholder="请输入地址" 
            value="{{address}}"
            bindinput="onAddressInput"
            maxlength="200"
          />
        </view>
      </view>

      <view class="modal-footer">
        <view class="btn btn-secondary" bindtap="onCloseModal">
          <text>取消</text>
        </view>
        <view class="btn btn-primary" bindtap="onSave">
          <text>保存</text>
        </view>
      </view>
    </view>
  </view>
</view>

