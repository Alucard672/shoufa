# 云函数超时配置说明

## 问题
云函数调用超时（3秒），错误代码：-504003

## 解决方案

### 方法一：在云开发控制台设置超时时间（推荐）

1. **打开云开发控制台**
   - 在微信开发者工具中，点击顶部"云开发"按钮
   - 或访问：https://console.cloud.tencent.com/tcb

2. **进入云函数管理**
   - 点击左侧菜单"云函数"
   - 找到 `mysql` 云函数

3. **配置超时时间**
   - 点击 `mysql` 函数名称进入详情页
   - 点击"配置"标签页
   - 找到"超时时间"设置
   - 将超时时间设置为 **60秒** 或更长
   - 点击"保存"

4. **重新部署**
   - 保存后，云函数会自动重新部署
   - 等待部署完成

### 方法二：通过代码配置（已更新）

我已经在 `cloudfunctions/mysql/config.json` 中添加了超时配置：

```json
{
  "timeout": 60
}
```

**注意**：需要重新上传云函数才能生效。

### 方法三：检查MySQL连接

如果超时问题持续存在，可能是MySQL连接问题：

1. **检查MySQL实例状态**
   - 在云开发控制台 → 数据库 → MySQL
   - 确认MySQL实例正常运行

2. **检查网络连接**
   - 确认云函数可以访问MySQL实例
   - 检查防火墙设置

3. **优化查询**
   - 确保数据库表已创建
   - 检查是否有索引

## 重新部署云函数

配置完成后，需要重新部署：

1. **右键点击** `cloudfunctions/mysql` 文件夹
2. **选择** "上传并部署：云端安装依赖"
3. **等待** 部署完成（可能需要几分钟）

## 验证

部署完成后，再次尝试创建租户：
1. 打开小程序
2. 进入"初始化租户"页面
3. 填写租户信息
4. 点击"创建租户"

如果仍然超时，请检查：
- 云函数日志（控制台 → 云函数 → mysql → 日志）
- MySQL实例状态
- 网络连接

